#include <QMetaClassInfo>
#include <QFile>
#include "malwarehandler.h"
MalwarePolicy MalwareHandler::m_policy;

QString MalwareHandler::getInfo() {
    MalwareHandler tmpobj;
    QString ver = QString(tmpobj.metaObject()->classInfo(0).name()) + ':' +  QString(tmpobj.metaObject()->classInfo(0).value());
    QString year = QString(tmpobj.metaObject()->classInfo(1).name()) + ':' +  QString(tmpobj.metaObject()->classInfo(1).value());
    return tr("%1 %2 \n%3").arg(tmpobj.metaObject()->className())
           .arg(ver)
           .arg(year);
}


bool MalwareHandler::HandleMalware(const QString &fileName) {
    switch (m_policy) {
    case POL_REMOVE:
        return QFile::remove(fileName);
        break;
    default:
        break;
    }
}
