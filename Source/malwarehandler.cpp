#include <QMetaClassInfo>
#include <QFile>
#include <QMessageBox>
#include "malwarehandler.h"
MalwarePolicy MalwareHandler::m_policy;

QString MalwareHandler::getInfo() {
    MalwareHandler tmpobj;
    QString ver = QString(tmpobj.metaObject()->classInfo(0).name()) + ':' +  QString(tmpobj.metaObject()->classInfo(0).value());
    QString year = QString(tmpobj.metaObject()->classInfo(1).name()) + ':' +  QString(tmpobj.metaObject()->classInfo(1).value());
    return tr("%1 %2 \n%3").arg(tmpobj.metaObject()->className())
            .arg(ver)
            .arg(year);
}


bool MalwareHandler::HandleMalware(const QString &fileName) {
    int reply = 0;
    switch (m_policy) {
    case MPOL_REMOVE:
        return QFile::remove(fileName);
        break;
    case MPOL_ASK:
        reply = QMessageBox::question(NULL, tr("Remove File ?"), tr("Delete this file %1").arg(fileName), QMessageBox::Yes, QMessageBox::No);
        if (reply == QMessageBox::Yes) {
            return QFile::remove(fileName);
        }
        break;
    default:
        break;
    }
    return false;
}
